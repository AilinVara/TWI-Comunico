<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Ejercicios de Velocidad</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
        }

        .drop-area {
            width: 300px;
            height: 100px;
            border: 2px dashed #ccc;
            margin: 10px auto;
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .letter {
            width: 50px;
            height: 50px;
            border: 1px solid #000;
            display: inline-block;
            margin: 5px;
            cursor: grab;
            background-color: #f9f9f9;
            text-align: center;
            line-height: 50px;
        }

        button {
            margin-top: 20px;
            padding: 10px 20px;
            font-size: 16px;
        }

        .message {
            margin-top: 20px;
            font-size: 18px;
            color: green;
        }
    </style>
</head>
<body>
<h1>Ejercicios de Velocidad</h1>
<div th:each="ejercicio, iterStat : ${ejercicios}">
    <div th:if="${iterStat.index == indiceEjercicio}">
        <h2 th:text="${ejercicio.palabra}">Palabra</h2>
        <div class="drop-area" id="dropArea">

            <p>Arrastra las letras aqu√≠</p>
        </div>
        <div th:each="letra : ${ejercicio.letras}">
            <div class="letter" th:text="${letra}" draggable="true" ondragstart="drag(event)"></div>
        </div>
        <form action="/verificarRespuesta" method="post">
            <input type="hidden" name="respuestaUsuario" id="respuestaUsuario" value="">
            <button type="submit">Verificar</button>
        </form>

        <div th:if="${mensaje}" class="message">
            <p th:text="${mensaje}"></p>
        </div>
    </div>
</div>

<script>
    function drag(ev) {
        ev.dataTransfer.setData("text", ev.target.innerText);
    }

    const dropArea = document.getElementById("dropArea");
    dropArea.addEventListener("dragover", function (ev) {
        ev.preventDefault();
    });

    dropArea.addEventListener("drop", function (ev) {
        ev.preventDefault();
        const data = ev.dataTransfer.getData("text");

        const letterDiv = document.createElement("div");
        letterDiv.innerText = data;
        letterDiv.classList.add("letter");
        this.appendChild(letterDiv);

        updateRespuestaUsuario();
    });

    function updateRespuestaUsuario() {
        const letters = dropArea.getElementsByClassName("letter");
        let respuesta = '';
        for (let i = 0; i < letters.length; i++) {
            respuesta += letters[i].innerText;
        }
        document.getElementById("respuestaUsuario").value = respuesta;
    }
</script>
</body>
</html>